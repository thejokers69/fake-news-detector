name: Upload model artifacts

on:
    workflow_dispatch:
        inputs:
            model_url:
                description: "HTTPS URL to fake_news_model.pkl"
                required: true
            vectorizer_url:
                description: "HTTPS URL to tfidf_vectorizer.pkl"
                required: true

jobs:
    upload:
        runs-on: ubuntu-latest
        env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Download model files
              run: |
                  mkdir -p models
                    # Use auth header so private repos/releases work (public still fine)
                    curl -fL -H "Authorization: Bearer ${GITHUB_TOKEN}" "${{ github.event.inputs.model_url }}" -o models/fake_news_model.pkl
                    curl -fL -H "Authorization: Bearer ${GITHUB_TOKEN}" "${{ github.event.inputs.vectorizer_url }}" -o models/tfidf_vectorizer.pkl
                  ls -lh models

            - name: Upload artifacts
              uses: actions/upload-artifact@v4
              with:
                  name: models-bundle
                  path: models/*.pkl
                  if-no-files-found: error
